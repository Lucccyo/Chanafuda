<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background-color: rgb(230, 222, 212);
      /* background-image: url('/hanafudraw_complet.png'); */
      margin: 0;
    }

    .game {
      display: flex;
      flex-direction: column;
      height: 100vh;
      width: 100vw;
    }

    .bloc {
      height: 33.333%;
      width: 100%;
      display: flex;
      align-items: center;
    }

    .carte {
      height: 117px;
      width: 70px;
      margin: 5px;
      background-color: rgb(136, 113, 82);
      /* background-position: 0px 0; */
    }

    .v {
      background-image: url('/hanafudraw_complete_edited.png');
    }

    .main {
      display: flex;
      flex-direction: row;
      width: 100%;
    }

    .demi {
      display: flex;
      height: 100%;
      width: 50%;
      align-items: center;
    }

    .right .carte {
      background-color: rgb(233, 210, 182);
    }

    #mid .board {
      display: flex;
      flex-direction: column;
      margin-left: 30vw;
    }

    #mid .board .rangee {
      display: flex;
    }

    .tas {
      background-color: rgb(71, 60, 44);
    }

    button {
      width: 100%;
      height: 100%;
      background-color: rgba(136, 113, 82, 0);
    }




    #c0101 {
      background-position: 0px 0;
    }
    
    #c0102 {
      background-position: 0px 0;
    }
    
    #c01RP {
      background-position: 0px 0;
    }
    
    #c01BB {
      background-position: 0px 0;
    }
    
    #c0201 {
      background-position: 0px 0;
    }
    
    #c0202 {
      background-position: 0px 0;
    }
    
    #c02RP {
      background-position: 0px 0;
    }
    
    #c02A0 {
      background-position: 0px 0;
    }
    
    #c0301 {
      background-position: 0px 0;
    }
    
    #c0302 {
      background-position: 0px 0;
    }
    
    #c03RP {
      background-position: 0px 0;
    }
    
    #c03BC {
      background-position: 0px 0;
    }
    
    #c0401 {
      background-position: 200px 0;
    }
    
    #c0402 {
      background-position: 0px 0;
    }
    
    #c04RR {
      background-position: 0px 0;
    }
    
    #c04A0 {
      background-position: 0px 0;
    }
    
    #c0501 {
      background-position: 0px 0;
    }
    
    #c0502 {
      background-position: 0px 0;
    }
    
    #c05RR {
      background-position: 0px 0;
    }
    
    #c05A0 {
      background-position: 0px 0;
    }
    
    #c0601 {
      background-position: 0px 0;
    }
    
    #c0602 {
      background-position: 0px 0;
    }
    
    #c06RV {
      background-position: 0px 0;
    }
    
    #c06AC {
      background-position: 0px 0;
    }
    
    #c0701 {
      background-position: 0px 0;
    }
    
    #c0702 {
      background-position: 0px 0;
    }
    
    #c07RR {
      background-position: 0px 0;
    }
    
    #c07AI {
      background-position: 0px 0;
    }
    
    #c0801 {
      background-position: 0px 0;
    }
    
    #c0802 {
      background-position: 0px 0;
    }
    
    #c08A0 {
      background-position: 0px 0;
    }
    
    #c08BM {
      background-position: 0px 0;
    }
    
    #c0901 {
      background-position: 0px 0;
    }
    
    #c0902 {
      background-position: 0px 0;
    }
    
    #c09RV {
      background-position: 0px 0;
    }
    
    #c09AW {
      background-position: 0px 0;
    }
    
    #c1001 {
      background-position: 0px 0;
    }
    
    #c1002 {
      background-position: 0px 0;
    }
    
    #c10RV {
      background-position: 0px 0;
    }
    
    #c10AS {
      background-position: 0px 0;
    }
    
    #c1101 {
      background-position: 0px 0;
    }
    
    #c11RR {
      background-position: 0px 0;
    }
    
    #c11A0 {
      background-position: 0px 0;
    }
    
    #c11BR {
      background-position: 0px 0;
    }
    
    #c1201 {
      background-position: 0px 0;
    }
    
    #c1202 {
      background-position: 0px 0;
    }
    
    #c1203 {
      background-position: 0px 0;
    }
    
    #c12BD {
      background-position: 0px 0;
    }
    
  </style>
  <script src="/socket.io/socket.io.js"></script>
  <title>Hanafuda</title>
</head>

<body>
  <!-- <img src="./petit.png" alt=""> -->
  <div class="game">
    <div class="bloc" id="top">
      <div class="left demi" id="enemy">

      </div>
      <div class="right demi">
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
      </div>
    </div>
    <div class="bloc" id="mid">
      <div class="carte tas" id="tas"></div>
      <div class="board">
        <div class="top rangee" id="board_top">

        </div>
        <div class="bot rangee" id="board_bot">

        </div>
      </div>
    </div>
    <div class="bloc" id="bot">
      <div class="left demi" id="perso">

      </div>
      <div class="right demi">
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
        <div class="carte"></div>
      </div>
    </div>
  </div>


  <script>
    var socket = io();

    var enemy_stack = document.getElementById('enemy');
    var perso_stack = document.getElementById('perso');
    var board_top = document.getElementById('board_top');
    var board_bot = document.getElementById('board_bot');
    var tas = document.getElementById('tas');

    // my cards
    socket.on('perso', function (tab) {
      perso_stack.innerHTML = '';
      for (let i = 0; i < tab.length; i++) {
        add_card(tab[i], perso_stack);
      }
    });

    function add_card(nom, stack) {
      var div = document.createElement("div");
      div.classList.add('carte');
      div.classList.add('v');
      card_name = 'c'.concat('', nom);
      div.setAttribute('id', card_name);
      div.innerText = nom;
      stack.append(div);
    }
    // *******


    // enemy cards
    socket.on('enemy', function (nb_card) {
      enemy_stack.innerHTML = '';
      for (let i = 0; i < nb_card; i++) {
        add_enemy_card();
      }
    });

    function add_enemy_card() {
      var div = document.createElement("div");
      div.classList.add('carte');
      enemy_stack.append(div);
    }
    // *******


    // board cards
    socket.on('board', function (tab) {
      board_bot.innerHTML = '';
      board_top.innerHTML = '';
      for (let i = 0; i < tab.length; i++) {
        if (i % 2 == 0) {
          add_board_card(tab[i], board_top, i);
        } else {
          add_board_card(tab[i], board_bot, i);
        }
      }
    });

    function add_board_card(nom, stack, index) {
      var div = document.createElement("div");
      div.classList.add('carte');
      div.classList.add('v');
      div.setAttribute('id', index);
      card_name = 'c'.concat('', nom);
      div.setAttribute('id', card_name);
      div.innerText = nom;
      stack.append(div);
    }
    // *******


    // playable cards
    socket.on('playable', function (tab) {
      for (let i = 0; i < tab.length; i++) {
        var div = document.getElementById('c'.concat('', tab[i]))
        var p = document.createElement("button");
        p.onclick = function () {

          if (((div.parentNode).id) == 'perso') {
            send_card_turn(tab[i]);
          } else {
            send_card_choice(tab[i]);
          }
        }
        div.appendChild(p);
      }
    });

    function send_card_turn(card_n) {
      // envoie de la carte cliquée
      socket.emit('turn', card_n);
    }

    function send_card_choice(card_choose) {
      // envoie de la carte cliquée
      // if (tas.textContent == null) {
      //   tab = ['h', card_choose];
      //   socket.emit('choice', tab);
      // } else {
      tab = ['s', card_choose];
      socket.emit('choice', tab);
      // }
    }
    // *******


    // number of cards in stack
    socket.on('pile', function (nb_card) {
      console.log("Dans la pile, il y a " + nb_card + " cartes.");
    });
    // *******


    // display wich card is drawn
    socket.on('draw', function (card_name) {
      if (card_name == 'v') {
        tas.textContent = '';
        console.log(card_name);
      } else {
        tas.textContent = card_name;
        console.log(card_name);
      }
    });
// *******
  </script>
</body>

</html>